{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\nimport axios from 'axios';\n\nconst activeForm = document.querySelector(`.form`);\nconst API_KEY = `41787862-84986491f6cfdcc41b6404efb`;\nconst loaderContainer = document.querySelector('.loader-container');\nconst loadButton = document.getElementById(`load-button`);\nlet page = 1;\nlet hits = [];\nlet query;\nconst perPage = 40;\n\naxios.defaults.baseURL= `https://pixabay.com`;\n\nasync function getImage(query = \"\") {\n    try {\n        const response = await axios.get(\"/api/\", {\n            params: {\n                key: API_KEY,\n                q: query,\n                image_type: \"photo\",\n                orientation: \"horizontal\",\n                safesearch: true,\n                page: page,\n                per_page: perPage,\n            },\n        });\n        hideLoader();\n        return response.data;\n    } catch (error) {\n        iziToast.show({\n            message: `${error}`,\n            color: \"red\",\n            position: \"topRight\",\n        });\n    }\n}\n\n\n\nfunction showLoader() {\n    loaderContainer.style.display = 'block';\n  }\n function hideLoader() {\n    loaderContainer.style.display = 'none';\n  }\n\n  \n\nactiveForm.addEventListener(\"submit\", (event) => {\n    event.preventDefault();\n\n     query = event.target.elements.query.value.trim();\n     \n\nshowLoader();\nloadButton.style.display = \"none\";\n\nclearSearchResults();\n\npage = 1;\n       getImage(query)\n    .then(({hits, totalHits}) => { \n        if (hits.length === 0) {\n            \n            iziToast.show({\n                message: \"Sorry, there are no images matching your search query. Please try again!\",\n                color: \"red\",\n  position: \"topRight\",  \n            });\n        } else {\n            renderImages(hits);\n            if (totalHits <= perPage) {\n                loadButton.style.display = \"none\";\n            } else {\n                loadButton.style.display = \"block\";}\n        }\n        event.target.reset();\n        \n    })\n    .catch(error => {\n        iziToast.show({\n            message: `${error}`,\n            color: \"red\",\nposition: \"topRight\",  \n        });\n    });\n    \n    \n})\n\n\nconst gallery = document.querySelector(`.gallery`);\n\nfunction clearSearchResults() {\n    gallery.innerHTML = \"\";\n    \n}\n\nconst lightbox = new SimpleLightbox('.gallery a', {\n    captionDelay: 250,\n    captionsData: 'alt',\n    close: true,\n  });\n\n function renderImages(hits) {\n    const imageHTML = hits.map(({webformatURL, largeImageURL, tags, likes, views, comments, downloads}) => `\n<a class=\"gallery-link\" href=\"${largeImageURL}\">\n<img\n    class=\"gallery-image\"\n    src=\"${webformatURL}\"\n    alt=\"${tags}\"\n/>\n<ul class=\"info-list\">\n  <li class=\"info-item\">\n      <p class=\"info-title\">Likes</p>\n      <p class=\"info-value\">${likes}</p>\n  </li>\n  <li class=\"info-item\">\n      <p class=\"info-title\">Views</p>\n      <p class=\"info-value\">${views}</p>\n  </li>\n  <li class=\"info-item\">\n      <p class=\"info-title\">Comments</p>\n      <p class=\"info-value\">${comments}</p>\n  </li>\n  <li class=\"info-item\">\n      <p class=\"info-title\">Downloads</p>\n      <p class=\"info-value\">${downloads}</p>\n  </li>\n</ul>\n</a> `).join(``)\n    \n     gallery.insertAdjacentHTML(\"beforeend\",imageHTML);\n     lightbox.refresh();\n     \n}\n\n\nloadButton.addEventListener(\"click\", () => {\n    loadButton.style.display = \"none\";\n    showLoader();\n    loadMore();\n    \n});\n\n\n\nasync function loadMore(event) {\n    \n    const listItem = document.querySelector(\".gallery-link:first-child\");\n    const itemHeight = listItem.getBoundingClientRect().height;\n\n    try {\n        page += 1;\n        const { hits, totalHits } = await getImage(query, page);\n        const totalPages = Math.ceil(totalHits / perPage);\n        renderImages(hits);\n        lightbox.refresh();\n        \n        if (page === totalPages) {\n            \n            loadButton.style.display = \"none\";\n            iziToast.show({\n                message: \"We're sorry, but you've reached the end od search results\",\n                position: \"topRight\",\n                messageColor: \"#ffffff\",\n                    titleColor: \"#ffffff\",\n                    iconColor: \"#ffffff\",\n                    backgroundColor: \"#EF4040\",\n            });\n        } else {\n            loadButton.style.display = \"block\";\n        }\n    } catch (error) {\n       iziToast.show({\n            message: `${error}`,\n            color: \"red\",\nposition: \"topRight\",  \n        });\n    } finally {\n        window.scrollBy({\n            top: 2 * itemHeight,\n            behavior: \"smooth\",\n        });\n    }\n}"],"names":["activeForm","API_KEY","loaderContainer","loadButton","page","query","perPage","axios","getImage","response","hideLoader","error","iziToast","showLoader","event","clearSearchResults","hits","totalHits","renderImages","gallery","lightbox","SimpleLightbox","imageHTML","webformatURL","largeImageURL","tags","likes","views","comments","downloads","loadMore","itemHeight","totalPages"],"mappings":"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"}